---
title: "International Relations Research with R"
categories:
  - Academic Research
tags:
  - R
  - software
  - International Relations
  - research
author_profile: false
---

I've spent much of the last few weeks helping students execute their senior thesis research in R. Here are some of the R packages and techniques that I have found to be most useful in International Relations (IR) research. I'm writing this as a note to my future self as much as anything, but maybe others will find it useful.

## IR Data

There are a few packages that allow for downloading IR datasets directly from R. These can be very useful, but one needs to be mindful of reproducibility concerns. I recommend using these packages to download the data, save it as a csv, and then in the future use the csv rather than the package. In some cases it may be possible to specify an exact version of the dataset, in which case this step would be unnecessary.

[WDI](https://vincentarelbundock.github.io/WDI/) provides an R interface to the World Bank's World Development Indicators.

[pwt9](https://cran.r-project.org/web/packages/pwt9/index.html) downloads the latest Penn World Table data.

There are numerous others, but in my experience, they are not always actively maintained and updated.

## IR Data Structures

Working with IR data presents some unique challenges.

### Useful Packages

[countrycode](https://github.com/vincentarelbundock/countrycode) converts between a large number of country identifier schemes.

[states](https://github.com/andybega/states) makes it very easy to create empty frames of country-years `state_panel` command. The `sfind` command is also very useful for looking up country codes.

I haven't used the [peacesciencer](https://github.com/svmiller/peacesciencer) package as it is very new, but it appears to improve on `states` with the ability to create not only country-year datasets, but directed and undirected dyad-years. It can also seamlessly merge in several Correlates of War and related datasets. 

### Creating Your Own Dyads and Dyad-Years From Scratch

If you need to create your own dyads or dyad-years, you could do something like the following using the unique values of the country variable in a dataset. You can use `states::state_panel()` to create a country list if you don't already have one.

```r
library(states)

states <- state_panel(start = 2016, end = 2017, useGW = TRUE)

head(states)

  gwcode year
1      2 2016
2      2 2017
3     20 2016
4     20 2017
5     31 2016
6     31 2017

# use expand.grid on the unique values of each variable
dyads <- expand.grid(statea = unique(states$gwcode), stateb = unique(states$gwcode), year = unique(states$year))

# remove self-self dyads
dyads <- subset(dyads, statea != stateb)

# sort in the conventional IR way
dyads <- dyads[with(dyads, order(statea, stateb, year)),]

# reset row numbers
rownames(dyads) <- NULL

head(dyads)

  statea stateb year
1      2     20 2016
2      2     20 2017
3      2     31 2016
4      2     31 2017
5      2     40 2016
6      2     40 2017
```

We now have a row for every combination of states and years in our original dataset. `tidyr` has its own version of `expand_grid`. I didn't use it here because it doesn't allow the same vector to be used twice, but it is faster, so it might be preferable for larger numbers of years.

### Expanding Date Sequences

Some IR datasets use a date range (sometimes referred to as spell) format like this:

```
head(data)

    statea  regime  styear  eyear
1   2       7       1970    1977
2   2       8       1978    1990  
```

For most purposes, however, we want the data to be long format with one row per country-year. We can make the conversion like so:

```
library(dplyr)

data  %>% 
  rowwise() %>% 
  mutate(year = list(seq(styear, eyear))) %>% 
  unnest(cols = c(year))

   statea regime styear eyear  year
 1      2      7   1970  1977  1970
 2      2      7   1970  1977  1971
 3      2      7   1970  1977  1972
 4      2      7   1970  1977  1973
 5      2      7   1970  1977  1974
```

## Other Data Tools

The [janitor](https://github.com/sfirke/janitor) package handles many data cleaning tasks out of the box, including making column names R-friendly.

The [tidyverse](https://www.tidyverse.org/) lives up to the hype as a fast, intuitive framework for data manipulation. `dplyr` is particularly useful for tasks including aggregating, reshaping, recoding, and merging data. `haven` and `readxl` facilitate importing data formats including Stata and SPSS that R doesn't support natively.

[sjlabelled](https://strengejacke.github.io/sjlabelled/) and [sjmisc](https://strengejacke.github.io/sjmisc/) add support for labelled data which is common in survey research and well supported in SPSS and Stata, but not base R.

There are many useful packages in the extended tidyverse as well. [tsibble](https://github.com/tidyverts/tsibble) provides some nice utilities for working with time series and panel data.

[tidygeocoder](https://github.com/jessecambon/tidygeocoder) is the most robust geocoder I've found for R.

[data.table](https://rdatatable.gitlab.io/data.table/) has largely been supplanted by the tidyverse, but it does provide some very specialized data manipulation tasks such as fuzzy date matching that have yet to be implemented in the tidyverse.

There are several packages that create new data formats offering better speed for loading and/or manipulating data. [fst](https://www.fstpackage.org/) appears to be among the best options currently.

## Visualization

- ggplot2
- plotly
- sjPlot

## Analysis

- fixest / bife / survival::clogit / expandar
- ggeffect
- coeftest / multiwaycov

## Output

- modelsummary